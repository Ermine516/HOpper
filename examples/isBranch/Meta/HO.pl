:-['../../../metagol'].
metagol:timeout(300).
%% background knowledge
head([H|_],H).
tail([_|T],T).
singleton([_]).
%% metarules

metarule([P,Q,R,W], [P,A,B],  [[Q,R,W,A,B]]).
metarule([P,Q,R],   [P,A,B],  [[Q,B,A],[R,B]]).
metarule([P,Q,R],   [P,A,B],  [[Q,B,C],[R,A,C]]):- metagol:type(R,2,head_pred).
metarule([P,Q,R,W], [P,A,B,C],[[Q,C,A],[R,W,B,C]]).

%% Expected solution
%f(A,B)    :- casetree(f_1,f_2,A,B).
%f_1(A,B)  :- head(B,A),singleton(B).
%f_2(A,B,C):- head(C,A),any(f_3,B,C).
%f_3(A,B)  :- tail(B,C),f(A,C).


body_pred(head,2).
body_pred(tail,2).
body_pred(singleton,1).

%% interpreted BK
ibk([casetree, P, _, t(R,[]),A],[ [P,R,A]  ]).
ibk([casetree, _, Q, t(R,C) ,A],[ [Q,R,C,A]]).

ibk([any,P,[H|_],A],[[P,H,A]]).
ibk([any,P,[_|T],A],[[any,P,T,A]]).



a:-
    Pos = [
        f(t(9,[t(6,[t(8,[])]),t(9,[])]),[9,6,8]),
	f(t(9,[t(6,[t(8,[])]),t(9,[])]),[9,9]),
	f(t(8,[t(1,[]),t(5,[t(9,[])]),t(7,[t(5,[]),t(2,[]),t(7,[])])]),[8,1]),
	f(t(8,[t(1,[]),t(5,[t(9,[])]),t(7,[t(5,[]),t(2,[]),t(7,[])])]),[8,5,9]),
	f(t(8,[t(1,[]),t(5,[t(9,[])]),t(7,[t(5,[]),t(2,[]),t(7,[])])]),[8,7,5]),
	f(t(8,[t(1,[]),t(5,[t(9,[])]),t(7,[t(5,[]),t(2,[]),t(7,[])])]),[8,7,2]),
	f(t(8,[t(1,[]),t(5,[t(9,[])]),t(7,[t(5,[]),t(2,[]),t(7,[])])]),[8,7,7]),
	f(t(7,[t(6,[]),t(7,[t(6,[]),t(4,[]),t(7,[]),t(1,[])]),t(9,[t(6,[]),t(7,[]),t(5,[]),t(2,[])])]),[7,6]),
	f(t(7,[t(6,[]),t(7,[t(6,[]),t(4,[]),t(7,[]),t(1,[])]),t(9,[t(6,[]),t(7,[]),t(5,[]),t(2,[])])]),[7,7,6]),
	f(t(7,[t(6,[]),t(7,[t(6,[]),t(4,[]),t(7,[]),t(1,[])]),t(9,[t(6,[]),t(7,[]),t(5,[]),t(2,[])])]),[7,7,4]),
	f(t(7,[t(6,[]),t(7,[t(6,[]),t(4,[]),t(7,[]),t(1,[])]),t(9,[t(6,[]),t(7,[]),t(5,[]),t(2,[])])]),[7,7,7]),
	f(t(7,[t(6,[]),t(7,[t(6,[]),t(4,[]),t(7,[]),t(1,[])]),t(9,[t(6,[]),t(7,[]),t(5,[]),t(2,[])])]),[7,7,1]),
	f(t(7,[t(6,[]),t(7,[t(6,[]),t(4,[]),t(7,[]),t(1,[])]),t(9,[t(6,[]),t(7,[]),t(5,[]),t(2,[])])]),[7,9,6]),
	f(t(7,[t(6,[]),t(7,[t(6,[]),t(4,[]),t(7,[]),t(1,[])]),t(9,[t(6,[]),t(7,[]),t(5,[]),t(2,[])])]),[7,9,7]),
	f(t(7,[t(6,[]),t(7,[t(6,[]),t(4,[]),t(7,[]),t(1,[])]),t(9,[t(6,[]),t(7,[]),t(5,[]),t(2,[])])]),[7,9,5]),
	f(t(7,[t(6,[]),t(7,[t(6,[]),t(4,[]),t(7,[]),t(1,[])]),t(9,[t(6,[]),t(7,[]),t(5,[]),t(2,[])])]),[7,9,2]),
	f(t(9,[t(3,[]),t(10,[]),t(7,[]),t(9,[])]),[9,3]),
	f(t(9,[t(3,[]),t(10,[]),t(7,[]),t(9,[])]),[9,10]),
	f(t(9,[t(3,[]),t(10,[]),t(7,[]),t(9,[])]),[9,7]),
	f(t(9,[t(3,[]),t(10,[]),t(7,[]),t(9,[])]),[9,9]),
	f(t(6,[t(0,[t(4,[])]),t(8,[t(8,[]),t(8,[])]),t(1,[t(6,[])]),t(4,[])]),[6,0,4]),
	f(t(6,[t(0,[t(4,[])]),t(8,[t(8,[]),t(8,[])]),t(1,[t(6,[])]),t(4,[])]),[6,8,8]),
	f(t(6,[t(0,[t(4,[])]),t(8,[t(8,[]),t(8,[])]),t(1,[t(6,[])]),t(4,[])]),[6,8,8]),
	f(t(6,[t(0,[t(4,[])]),t(8,[t(8,[]),t(8,[])]),t(1,[t(6,[])]),t(4,[])]),[6,1,6]),
	f(t(6,[t(0,[t(4,[])]),t(8,[t(8,[]),t(8,[])]),t(1,[t(6,[])]),t(4,[])]),[6,4]),
	f(t(10,[]),[10]),
	f(t(1,[t(4,[t(6,[]),t(6,[])])]),[1,4,6]),
	f(t(1,[t(4,[t(6,[]),t(6,[])])]),[1,4,6]),
	f(t(7,[]),[7]),
	f(t(3,[t(2,[]),t(9,[t(6,[]),t(0,[])]),t(4,[])]),[3,2]),
	f(t(3,[t(2,[]),t(9,[t(6,[]),t(0,[])]),t(4,[])]),[3,9,6]),
	f(t(3,[t(2,[]),t(9,[t(6,[]),t(0,[])]),t(4,[])]),[3,9,0]),
	f(t(3,[t(2,[]),t(9,[t(6,[]),t(0,[])]),t(4,[])]),[3,4]),
	f(t(3,[t(6,[t(1,[])]),t(10,[t(4,[]),t(8,[]),t(4,[])]),t(3,[t(1,[]),t(9,[]),t(9,[]),t(2,[])]),t(6,[t(10,[])])]),[3,6,1]),
	f(t(3,[t(6,[t(1,[])]),t(10,[t(4,[]),t(8,[]),t(4,[])]),t(3,[t(1,[]),t(9,[]),t(9,[]),t(2,[])]),t(6,[t(10,[])])]),[3,10,4]),
	f(t(3,[t(6,[t(1,[])]),t(10,[t(4,[]),t(8,[]),t(4,[])]),t(3,[t(1,[]),t(9,[]),t(9,[]),t(2,[])]),t(6,[t(10,[])])]),[3,10,8]),
	f(t(3,[t(6,[t(1,[])]),t(10,[t(4,[]),t(8,[]),t(4,[])]),t(3,[t(1,[]),t(9,[]),t(9,[]),t(2,[])]),t(6,[t(10,[])])]),[3,10,4]),
	f(t(3,[t(6,[t(1,[])]),t(10,[t(4,[]),t(8,[]),t(4,[])]),t(3,[t(1,[]),t(9,[]),t(9,[]),t(2,[])]),t(6,[t(10,[])])]),[3,3,1]),
	f(t(3,[t(6,[t(1,[])]),t(10,[t(4,[]),t(8,[]),t(4,[])]),t(3,[t(1,[]),t(9,[]),t(9,[]),t(2,[])]),t(6,[t(10,[])])]),[3,3,9]),
	f(t(3,[t(6,[t(1,[])]),t(10,[t(4,[]),t(8,[]),t(4,[])]),t(3,[t(1,[]),t(9,[]),t(9,[]),t(2,[])]),t(6,[t(10,[])])]),[3,3,9]),
	f(t(3,[t(6,[t(1,[])]),t(10,[t(4,[]),t(8,[]),t(4,[])]),t(3,[t(1,[]),t(9,[]),t(9,[]),t(2,[])]),t(6,[t(10,[])])]),[3,3,2]),
	f(t(3,[t(6,[t(1,[])]),t(10,[t(4,[]),t(8,[]),t(4,[])]),t(3,[t(1,[]),t(9,[]),t(9,[]),t(2,[])]),t(6,[t(10,[])])]),[3,6,10])
    ],
    Neg =[
        f([],[]),
	f(t(3,[t(2,[]),t(9,[t(6,[]),t(0,[])]),t(4,[])]),[3,2,9]),
	f(t(3,[t(2,[]),t(9,[t(6,[]),t(0,[])]),t(4,[])]),[3,0]),
	f(t(3,[t(6,[t(1,[])]),t(10,[t(4,[]),t(8,[]),t(4,[])]),t(3,[t(1,[]),t(9,[]),t(9,[]),t(2,[])]),t(6,[t(10,[])])]),[3,6,2]),
	f(t(9,[t(6,[t(8,[])]),t(9,[])]),[])
    ],
    learn(Pos,Neg).
:- time(a).
