lic([H|T],H,T). 
trc(t(R,C),R,C).
lie([]).
tre(e).

any(P,[H|_],X) :- call(P,H,X).
any(P,[_|T],X) :- any(P,T,X). 

%f(X,Y):- tre(X),lie(Y).
%f(X,Y):- trc(X,R,C), lic(Y,R,T),  any(p,q,C,T).
%p(X,Y):- f(X,Y).
%q(X,Y):- tre(X),lie(Y).

%f(A,B):-any(any_p_a,any_q_a,A,B).
%f(A,B):-lic(B,E,C),trc(A,E,D),f(D,C).
%any_p_a(A,B):-f(A,B).
%any_q_a(A,B):-tre(A),lie(B).

f(A,B):-lie(D),tre(E),trc(A,C,E),lic(B,C,D).
f(A,B):-trc(A,C,D),lic(B,C,E),any(any_p_a,D,E).
any_p_a(A,B):-f(A,B).

:- begin_tests(lists).   
test(a2) :- f(t(9,[t(6,[t(8,e)]),t(9,e)]),[9,6,8]).
test(a3) :- f(t(9,[t(6,[t(8,e)]),t(9,e)]),[9,9]).
test(a4) :- f(t(8,[t(1,e),t(5,[t(9,e)]),t(7,[t(5,e),t(2,e),t(7,e)])]),[8,1]).
test(a5) :- f(t(8,[t(1,e),t(5,[t(9,e)]),t(7,[t(5,e),t(2,e),t(7,e)])]),[8,5,9]).
test(a6) :- f(t(8,[t(1,e),t(5,[t(9,e)]),t(7,[t(5,e),t(2,e),t(7,e)])]),[8,7,5]).
test(a7) :- f(t(8,[t(1,e),t(5,[t(9,e)]),t(7,[t(5,e),t(2,e),t(7,e)])]),[8,7,2]).
test(a8) :- f(t(8,[t(1,e),t(5,[t(9,e)]),t(7,[t(5,e),t(2,e),t(7,e)])]),[8,7,7]).
test(a9) :- f(t(7,[t(6,e),t(7,[t(6,e),t(4,e),t(7,e),t(1,e)]),t(9,[t(6,e),t(7,e),t(5,e),t(2,e)])]),[7,6]).
test(a10) :- f(t(7,[t(6,e),t(7,[t(6,e),t(4,e),t(7,e),t(1,e)]),t(9,[t(6,e),t(7,e),t(5,e),t(2,e)])]),[7,7,6]).
test(a11) :- f(t(7,[t(6,e),t(7,[t(6,e),t(4,e),t(7,e),t(1,e)]),t(9,[t(6,e),t(7,e),t(5,e),t(2,e)])]),[7,7,4]).
test(a12) :- f(t(7,[t(6,e),t(7,[t(6,e),t(4,e),t(7,e),t(1,e)]),t(9,[t(6,e),t(7,e),t(5,e),t(2,e)])]),[7,7,7]).
test(a13) :- f(t(7,[t(6,e),t(7,[t(6,e),t(4,e),t(7,e),t(1,e)]),t(9,[t(6,e),t(7,e),t(5,e),t(2,e)])]),[7,7,1]).
test(a14) :- f(t(7,[t(6,e),t(7,[t(6,e),t(4,e),t(7,e),t(1,e)]),t(9,[t(6,e),t(7,e),t(5,e),t(2,e)])]),[7,9,6]).
test(a15) :- f(t(7,[t(6,e),t(7,[t(6,e),t(4,e),t(7,e),t(1,e)]),t(9,[t(6,e),t(7,e),t(5,e),t(2,e)])]),[7,9,7]).
test(a16) :- f(t(7,[t(6,e),t(7,[t(6,e),t(4,e),t(7,e),t(1,e)]),t(9,[t(6,e),t(7,e),t(5,e),t(2,e)])]),[7,9,5]).
test(a17) :- f(t(7,[t(6,e),t(7,[t(6,e),t(4,e),t(7,e),t(1,e)]),t(9,[t(6,e),t(7,e),t(5,e),t(2,e)])]),[7,9,2]).
test(a18) :- f(t(9,[t(3,e),t(10,e),t(7,e),t(9,e)]),[9,3]).
test(a19) :- f(t(9,[t(3,e),t(10,e),t(7,e),t(9,e)]),[9,10]).
test(a20) :- f(t(9,[t(3,e),t(10,e),t(7,e),t(9,e)]),[9,7]).
test(a21) :- f(t(9,[t(3,e),t(10,e),t(7,e),t(9,e)]),[9,9]).
test(a22) :- f(t(6,[t(0,[t(4,e)]),t(8,[t(8,e),t(8,e)]),t(1,[t(6,e)]),t(4,e)]),[6,0,4]).
test(a23) :- f(t(6,[t(0,[t(4,e)]),t(8,[t(8,e),t(8,e)]),t(1,[t(6,e)]),t(4,e)]),[6,8,8]).
test(a24) :- f(t(6,[t(0,[t(4,e)]),t(8,[t(8,e),t(8,e)]),t(1,[t(6,e)]),t(4,e)]),[6,8,8]).
test(a25) :- f(t(6,[t(0,[t(4,e)]),t(8,[t(8,e),t(8,e)]),t(1,[t(6,e)]),t(4,e)]),[6,1,6]).
test(a26) :- f(t(6,[t(0,[t(4,e)]),t(8,[t(8,e),t(8,e)]),t(1,[t(6,e)]),t(4,e)]),[6,4]).
test(a27) :- f(t(10,e),[10]).
test(a28) :- f(t(1,[t(4,[t(6,e),t(6,e)])]),[1,4,6]).
test(a29) :- f(t(1,[t(4,[t(6,e),t(6,e)])]),[1,4,6]).
test(a30) :- f(t(10,e),[10]).
test(a31) :- f(t(3,[t(2,e),t(9,[t(6,e),t(0,e)]),t(4,e)]),[3,2]).
test(a32) :- f(t(3,[t(2,e),t(9,[t(6,e),t(0,e)]),t(4,e)]),[3,9,6]).
test(a33) :- f(t(3,[t(2,e),t(9,[t(6,e),t(0,e)]),t(4,e)]),[3,9,0]).
test(a34) :- f(t(3,[t(2,e),t(9,[t(6,e),t(0,e)]),t(4,e)]),[3,4]).
test(a35) :- f(t(3,[t(6,[t(1,e)]),t(10,[t(4,e),t(8,e),t(4,e)]),t(3,[t(1,e),t(9,e),t(9,e),t(2,e)]),t(6,[t(10,e)])]),[3,6,1]).
test(a36) :- f(t(3,[t(6,[t(1,e)]),t(10,[t(4,e),t(8,e),t(4,e)]),t(3,[t(1,e),t(9,e),t(9,e),t(2,e)]),t(6,[t(10,e)])]),[3,10,4]).
test(a37) :- f(t(3,[t(6,[t(1,e)]),t(10,[t(4,e),t(8,e),t(4,e)]),t(3,[t(1,e),t(9,e),t(9,e),t(2,e)]),t(6,[t(10,e)])]),[3,10,8]).
test(a38) :- f(t(3,[t(6,[t(1,e)]),t(10,[t(4,e),t(8,e),t(4,e)]),t(3,[t(1,e),t(9,e),t(9,e),t(2,e)]),t(6,[t(10,e)])]),[3,10,4]).
test(a39) :- f(t(3,[t(6,[t(1,e)]),t(10,[t(4,e),t(8,e),t(4,e)]),t(3,[t(1,e),t(9,e),t(9,e),t(2,e)]),t(6,[t(10,e)])]),[3,3,1]).
test(a40) :- f(t(3,[t(6,[t(1,e)]),t(10,[t(4,e),t(8,e),t(4,e)]),t(3,[t(1,e),t(9,e),t(9,e),t(2,e)]),t(6,[t(10,e)])]),[3,3,9]).
test(a41) :- f(t(3,[t(6,[t(1,e)]),t(10,[t(4,e),t(8,e),t(4,e)]),t(3,[t(1,e),t(9,e),t(9,e),t(2,e)]),t(6,[t(10,e)])]),[3,3,9]).
test(a42) :- f(t(3,[t(6,[t(1,e)]),t(10,[t(4,e),t(8,e),t(4,e)]),t(3,[t(1,e),t(9,e),t(9,e),t(2,e)]),t(6,[t(10,e)])]),[3,3,2]).
test(a43) :- f(t(3,[t(6,[t(1,e)]),t(10,[t(4,e),t(8,e),t(4,e)]),t(3,[t(1,e),t(9,e),t(9,e),t(2,e)]),t(6,[t(10,e)])]),[3,6,10]).
test(a44,[fail]) :- f(e,[]).
test(a45,[fail]):- f(t(3,[t(2,e),t(9,[t(6,e),t(0,e)]),t(4,e)]),[3,2,9]).
test(a46,[fail]):- f(t(3,[t(2,e),t(9,[t(6,e),t(0,e)]),t(4,e)]),[3,0]).
test(a47,[fail]):- f(t(3,[t(6,[t(1,e)]),t(10,[t(4,e),t(8,e),t(4,e)]),t(3,[t(1,e),t(9,e),t(9,e),t(2,e)]),t(6,[t(10,e)])]),[3,6,2]).
test(a47,[fail]):- f(t(9,[t(6,[t(8,e)]),t(9,e)]),e).

:- end_tests(lists).


%f(t(6,[t(1,[])]),[6,2]).
%f(t(10,[t(4,[]),t(8,[]),t(4,[])]),[6,2]).
%f(t(3,[t(1,[]),t(9,[]),t(9,[]),t(2,[])]),t(6,[t(10,[])]),[6,2]).



